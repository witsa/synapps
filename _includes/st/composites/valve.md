{% raw %}
```text
SYNAPPS-STUDIO-COMPOSITE|{"config":{"key":"valve","name":"Vanne","properties":{"width":"100px"},"additionalDefs":{"resourcePath":{"type":"wos-path","label":"Vanne","helperTxt":"Chemin de la vanne depuis <code>:easy.RESS</code>","value":"","relativeToPath":":easy.RESS","variableType":"resourcesOnly"},"delay":{"type":"number","label":"Délai","helperTxt":"Délai de raffraichissement","value":10,"min":0,"unit":"s"},"autoRefresh":{"type":"boolean","label":"Raf. Auto?","helperTxt":"Raffraichissement automatique ?","value":true}}},"leadActor":{"type":"layout/stack","key":"root","children":[{"type":"layout/stack","key":"sources","children":[{"type":"redy/data-source/wos-variable","key":"resources","properties":{"mode":"relative","path":":easy.RESS"},"bindings":{"properties.autoRefreshDelay":"stage@properties.delay","properties.autoRefresh":"stage@properties.autoRefresh"}},{"type":"redy/data-source/wos-relative-variable","key":"valveVar","properties":{"dataReadMode":"always","relativeTo":"resources"},"bindings":{"properties.relativePath":"stage@properties.resourcePath","properties.relativeTo":""},"events":{"onDidDataStore":["const setVisible = (key, value) => context.getActor(key).properties.visible = value;","if (context.error || !context.data || context.data.classID !== 673) {","  setVisible('layers', false);","  return;","}","","setVisible('layers', true);",""],"properties/relativeTo/binding/onReadTransform":["console.log(context.value);","return context.value ? '' : 'resources';",""]}},{"type":"redy/data-source/wos-relative-variable","key":"runID","properties":{"relativePath":"RunID:value","relativeTo":"valveVar","dataReadMode":"always"},"events":{"onDidDataStore":["let runtID = null;","const setVisible = (key, value) => context.getActor(key).properties.visible = value;","if (context.error) {","  console.error(error);","} else {","  runID = context.data;","}","","setVisible('layers', !context.utils.isNone(runID));","","switch (runID) {","","  case 0:","    // Vanne fermée","    setVisible('flapClose', true);","    setVisible('flapOpening', false);","    setVisible('flapOpen', false);","    setVisible('flapClosing', false);","    break;","","  case 10: // Commande d'ouverture","  case 20: // Attend l'ouverture de la vanne","  case 30: // Met à vrai l'AckOpen","    setVisible('flapClose', false);","    setVisible('flapOpening', true);","    setVisible('flapOpen', false);","    setVisible('flapClosing', false);","    break;","","  case 50:","    // Vanne ouverte","    setVisible('flapClose', false);","    setVisible('flapOpening', false);","    setVisible('flapOpen', true);","    setVisible('flapClosing', false);","    break;","","  case 60: // Commande de fermeture","  case 70: // Attend la fermeture de la vanne","  case 80: // Met à vrai l'AckClose","    setVisible('flapClose', false);","    setVisible('flapOpening', false);","    setVisible('flapOpen', false);","    setVisible('flapClosing', true);","    break;","","  case -40: // Vanne en défaut","  case 90: // Initialisation de la vanne","  default:","    setVisible('flapClose', false);","    setVisible('flapOpening', false);","    setVisible('flapOpen', false);","    setVisible('flapClosing', false);","    break;","}"]}}]},{"type":"display/text","key":"tooltip","properties":{"content":"{{ressName}}\n{{state}}","visible":false},"additionalDefs":{"ressName":{"type":"text","label":"Nom du bruleur"},"state":{"type":"text","label":"Etat du bruleur"}},"bindings":{"additionals.ressName":{"relativeTo":"valveVar","relativePath":":name","source":"redy/wos-relative-variable"},"additionals.state":{"relativeTo":"valveVar","relativePath":":state","dataReadMode":"always","source":"redy/wos-relative-variable"}}},{"type":"layout/view-box","key":"view-box","children":[{"type":"layout/canvas","key":"layers","properties":{"overflowX":"visible","overflowY":"visible","height":"100px","width":"100px"},"children":[{"type":"display/image","key":"valve","properties":{"content":"data:image/gif;base64,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"}},{"type":"display/image","key":"flapClose","properties":{"top":"25px","left":"25px","content":"data:image/gif;base64,R0lGODlhMgAyAJEBAP///wAAAP8AAJ0eHiH5BAUUAAAALAAAFAAyAAsAAAI8hI+Zwe2hopzzWVqt3rz3AYbiSJbmGTKDwLbuC8fyLAwqjee6Haz6D2zxUMSiEeRJKpcQjMTjjEqhUkQBADs="}},{"type":"display/image","key":"flapOpen","properties":{"top":"25px","left":"25px","content":"data:image/gif;base64,R0lGODlhMgAyAJEBAP///wAAAP8AAJ0eHiH5BAUUAAAALBQAAAALADIAAAJdBIIZZjH/FnOiDtlGFZcdbWHf1k0gJ1Khp6LsWWZkCtPze5u5vOo97/IFgaVETdG6II8KpnG2hDalz1DUOsVWUQii7TcCJ7/DcHmME9fS57UwZoaj32S5OwORIyUFADs="}},{"type":"display/image","key":"flapOpening","properties":{"top":"25px","left":"25px","content":"data:image/gif;base64,R0lGODlhMgAyAJECAP////8AAAAAAJ0eHiH/C05FVFNDQVBFMi4wAwEAAAAh+QQNCgAAACwAABQAMgALAAACPISPmcLtoqKc81lard689wGG4kiW5hkyQ8C27gvH8hwMKo3nui2s+g9s8VDEohHkSSqXEIzE44xKoVJEAQAh+QQNCgAAACwCAAsALgAcAAACiAQkpsvt/8QYCNp7ZZgVe6wFIpd8ZhOKI1WeZ6quneshUxyT9GcPuKrbgSS+34YlHN6MJIRzljwQjcenM8roUZtQrEHLZLW8C/AvSM5Ow920dHlGur9OOA5Ntq7jbaHefCcX9VdXxDc2B5gjOPdmGNiXt3eH2Ki4UdnomJOpuUnhadHTGarQUQAAIfkEDQoAAAAsBQAFACgAKAAAAn+EIafL7StGerTCEaTdL4avcaLhfeA0cqUZptt6uipmZqhMwTZu6S3v8N2ADCGxQ2MNjwcjs5iMPS81m+CKfQqx1+k2641au1OEWEL2bsuI63lJ5L7LXCezbo/j52wSv59H98cWGFb1I3gIdzeYWINo+Lh4VKiVBJmISagJqFAAACH5BA0KAAAALAsAAgAcAC4AAAKAhIViy+0nhlSvtjiCHtTaqG2dV4EhR37ZOabXKrqPGcsOHaA2g+v70mvZgj8eLCeUEYuHo++3ZEahzqSymrCWsAlqCNndBcPDsbZkhiKw6nF76spW3/DhnAmoX79PLwuvt/cndUfId+YRGFfoV2M4WKSYIpkIM4GXJ8GBSJK1UAAAIfkEDR4AAAAsFAAAAAsAMgAAAl0EhClmMv8Wc6EO2UYNlx1tYd/WTSAnUqGnouxZZmQK0/N7m7m86j3v8gWBpURN0bogjwqmcbaENqXPUNQ6xVZRCKLtNwInv8NweYwT19LntTBmhqPfZLk7A5EjJQUAOw=="}},{"type":"display/image","key":"flapClosing","properties":{"top":"25px","left":"25px","content":"data:image/gif;base64,R0lGODlhMgAyAJECAP////8AAAAAAJ0eHiH/C05FVFNDQVBFMi4wAwEAAAAh+QQNCgAAACwUAAAACwAyAAACXQSEKWYy/xZzoQ7ZRg2XHW1h39ZNICdSoaei7FlmZArT83ububzqPe/yBYGlRE3RuiCPCqZxtoQ2pc9Q1DrFVlEIou03Aie/w3B5jBPX0ue1MGaGo99kuTsDkSMlBQAh+QQNCgAAACwLAAIAHAAuAAACgISFYsvtJ4ZUr7Y4gh7U2qhtnVeBIUd+2Tmm1yq6jxnLDh2gNoPr+9Jr2YI/HiwnlBGLh6Pvt2RGoc6kspqwlrAJagjZ3QXDw7G2ZIYisOpxe+rKVt/w4ZwJqF+/Ty8Lr7f3J3VHyHfmERhX6FdjOFikmCKZCDOBlyfBgUiStVAAACH5BA0KAAAALAUABQAoACgAAAJ/hCGny+0rRnq0whGk3S+Gr3Gi4X3gNHKlGabberoqZmaoTME2bukt7/DdgAwhsUNjDY8HI7OYjD0vNZvgin0KsdfpNuuNWrtThFhC9m7LiOt5SeS+y1wns26P4+dsEr+fR/fHFhhW9SN4CHc3mFiDaPi4eFSolQSZiEmoCahQAAAh+QQNCgAAACwCAAsALgAcAAACiAQkpsvt/8QYCNp7ZZgVe6wFIpd8ZhOKI1WeZ6quneshUxyT9GcPuKrbgSS+34YlHN6MJIRzljwQjcenM8roUZtQrEHLZLW8C/AvSM5Ow920dHlGur9OOA5Ntq7jbaHefCcX9VdXxDc2B5gjOPdmGNiXt3eH2Ki4UdnomJOpuUnhadHTGarQUQAAIfkEDR4AAAAsAAAUADIACwAAAjyEj5nC7aKinPNZWq3evPcBhuJIluYZMkPAtu4Lx/IcDCqN57otrPoPbPFQxKIR5EkqlxCMxOOMSqFSRAEAOw=="}}],"bindings":{"properties.toolTip":"actor#tooltip@completedContent"},"events":{"onInit":["if (!this.stage.isInDesigner) {","  this.properties.visible = false;","}"]}}]}],"additionalDefs":{"ressInDesigner":{"type":"wos-path","relativeToPath":":easy.RESS","variableType":"resourcesOnly"}},"additionals":{"ressInDesigner":"Prod.R00004.RessBoiler1.RessValve"},"bindings":{"properties.width":"stage@properties.width"},"events":{"properties/width/onValueChanged":["const W = 100;","const toPx = x => `${x}px`;","const getActor = key => this.stage.getActor(key);","const wPx = context.newValue;","if (!wPx || !wPx.includes('px')) {","  this.stage.properties.width = toPx(W);","  return;","}","","const w = parseFloat(wPx);","const r = w / W;","","getActor('view-box').properties.width = toPx(W * r);","getActor('view-box').properties.height = toPx(100 * r);",""],"additionals/ressInDesigner/onValueChanged":["if (this.stage.isInDesigner) {","  this.stage.properties.resourcePath = this.additionals.ressInDesigner;","}"],"onInit":["if (this.stage.isInDesigner) {","  this.stage.properties.resourcePath = this.additionals.ressInDesigner;","}"]}}}
```
{% endraw %}
